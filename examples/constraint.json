{
  "kind": "constraint",
  "constraint_id": "C-SEC-001",
  "name": "no-plaintext-secrets",
  "description": "No plaintext secrets may be committed or logged.",
  "scope": {
    "paths": ["auth/", "config/"]
  },
  "severity": "must",
  "priority": 100,
  "logic": {
    "language": "rego",
    "expression": "deny[msg] { input.contains_secret == true; msg := \"plaintext secret detected\" }",
    "version": "v1"
  },
  "evidence_requirements": [
    {
      "type": "scan",
      "selector": "secret-scan",
      "min_count": 1,
      "required": true
    }
  ],
  "owner": {
    "actor_id": "agent-security",
    "actor_type": "agent",
    "display_name": "Security Guardian"
  },
  "created_at": "2025-01-15T12:10:00Z"
}
